# 等高模型页面实现文档

## 概述

本页面实现了等高模型的交互式学习功能。等高模型是几何中的重要概念，指的是具有相同高度的三角形在面积计算中的特殊关系。通过动态调整底边长度和高度，用户可以直观地理解等高三角形的面积比例关系。

## 功能特性

### 核心功能
- **等高三角形面积计算**: 演示等高三角形面积与底边的关系
- **动态参数调整**: 通过滑块实时调整底边长度和高度
- **面积比例展示**: 直观显示不同等高三角形的面积比例
- **数学原理讲解**: 详细解释等高模型的数学原理

### 交互功能
- 滑块调整底边长度和高度
- 实时计算和显示面积
- 对比展示多个等高三角形
- 支持图形导出和保存

## 技术实现

### 文件结构
```
pages/3_等高模型.py
├── 导入模块
├── 字体配置
├── 页面配置
├── 绘图函数
├── 等高模型演示
├── 面积计算验证
└── 应用示例
```

### 核心算法

#### 1. 等高三角形面积计算
```python
def calculate_triangle_area(base, height):
    """
    计算三角形面积。
    
    公式：面积 = (底边 × 高) / 2
    
    Args:
        base: 底边长度
        height: 高（垂直于底边的距离）
    
    Returns:
        float: 三角形面积
    """
    return 0.5 * base * height

def calculate_height_from_area(area, base):
    """
    根据面积和底边计算高。
    
    公式：高 = (2 × 面积) / 底边
    
    Args:
        area: 三角形面积
        base: 底边长度
    
    Returns:
        float: 高
    """
    if base == 0:
        return 0
    return (2 * area) / base
```

#### 2. 等高三角形生成
```python
def generate_isosceles_triangles(base1, base2, height):
    """
    生成两个具有相同高度的三角形。
    
    Args:
        base1: 第一个三角形的底边长度
        base2: 第二个三角形的底边长度
        height: 共同的高度
    
    Returns:
        dict: 包含两个三角形的顶点坐标
    """
    # 确保底边有足够的间距
    spacing = max(base1, base2) * 0.2
    
    # 第一个三角形
    triangle1 = {
        'vertices': [
            (-base1/2, 0),
            (base1/2, 0),
            (0, height)
        ],
        'base': base1,
        'height': height,
        'area': calculate_triangle_area(base1, height)
    }
    
    # 第二个三角形
    offset = base1/2 + base2/2 + spacing
    triangle2 = {
        'vertices': [
            (offset - base2/2, 0),
            (offset + base2/2, 0),
            (offset, height)
        ],
        'base': base2,
        'height': height,
        'area': calculate_triangle_area(base2, height)
    }
    
    return {
        'triangle1': triangle1,
        'triangle2': triangle2,
        'area_ratio': base1 / base2 if base2 != 0 else float('inf')
    }
```

#### 3. 等高模型可视化
```python
def draw_isosceles_triangles_comparison(base1, base2, height):
    """
    绘制等高三角形的对比图。
    
    Args:
        base1: 第一个三角形的底边长度
        base2: 第二个三角形的底边长度
        height: 共同的高度
    
    Returns:
        matplotlib.figure.Figure: 绘制的图形对象
    """
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 8))
    
    # 生成三角形数据
    data = generate_isosceles_triangles(base1, base2, height)
    
    # 绘制第一个三角形
    tri1 = Polygon(data['triangle1']['vertices'], 
                   fill=True, alpha=0.7, color='lightblue')
    ax1.add_patch(tri1)
    
    # 添加标签
    ax1.text(0, -height*0.1, f'底边 = {base1}', ha='center', fontsize=12)
    ax1.text(-base1/2 - 0.5, height/2, f'高 = {height}', 
             ha='center', va='center', fontsize=12, rotation=90)
    ax1.text(0, height*0.5, f'面积 = {data["triangle1"]["area"]:.2f}', 
             ha='center', fontsize=12, weight='bold')
    
    # 绘制第二个三角形
    tri2 = Polygon(data['triangle2']['vertices'], 
                   fill=True, alpha=0.7, color='lightcoral')
    ax2.add_patch(tri2)
    
    # 添加标签
    offset = base1/2 + base2/2 + max(base1, base2) * 0.2
    ax2.text(offset, -height*0.1, f'底边 = {base2}', ha='center', fontsize=12)
    ax2.text(offset, height*0.5, f'面积 = {data["triangle2"]["area"]:.2f}', 
             ha='center', fontsize=12, weight='bold')
    
    # 设置坐标轴
    for ax in [ax1, ax2]:
        ax.set_aspect('equal')
        ax.grid(True, alpha=0.3)
        ax.set_ylim(-height*0.2, height*1.2)
    
    ax1.set_title(f'三角形1：底边={base1}, 面积={data["triangle1"]["area"]:.2f}', 
                  fontsize=14)
    ax2.set_title(f'三角形2：底边={base2}, 面积={data["triangle2"]["area"]:.2f}', 
                  fontsize=14)
    
    # 添加整体标题
    fig.suptitle('等高三角形面积对比', fontsize=16, y=0.98)
    
    return fig
```

#### 4. 等高模型数学原理
```python
def explain_height_model_principle():
    """
    解释等高模型的数学原理。
    
    Returns:
        dict: 包含原理说明和公式
    """
    return {
        "principle": """
        等高模型：当两个三角形具有相同的高度时，它们的面积比等于底边长度的比。
        
        数学表达：
        如果两个三角形的高相同，设为h，底边分别为b₁和b₂，则：
        面积₁ = (b₁ × h) / 2
        面积₂ = (b₂ × h) / 2
        
        因此：
        面积₁ / 面积₂ = b₁ / b₂
        """,
        "formula": "S₁/S₂ = b₁/b₂ (当h₁ = h₂时)",
        "applications": [
            "计算不规则图形的面积",
            "解决几何证明问题",
            "工程测量中的面积计算",
            "地图学中的面积估算"
        ]
    }
```

### 页面布局设计

#### 1. 主界面结构
```python
def main():
    """等高模型页面的主函数。"""
    
    # 页面标题和介绍
    st.title("📏 等高模型")
    st.markdown("探索具有相同高度的三角形面积关系")
    
    # 创建控制面板
    st.sidebar.header("参数调整")
    
    base1 = st.sidebar.slider("三角形1底边长度", 
                             min_value=1.0, max_value=10.0, value=4.0, step=0.5)
    base2 = st.sidebar.slider("三角形2底边长度", 
                             min_value=1.0, max_value=10.0, value=6.0, step=0.5)
    height = st.sidebar.slider("共同高度", 
                              min_value=1.0, max_value=8.0, value=3.0, step=0.5)
    
    # 计算面积
    area1 = calculate_triangle_area(base1, height)
    area2 = calculate_triangle_area(base2, height)
    
    # 显示计算结果
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.metric("三角形1面积", f"{area1:.2f}")
    with col2:
        st.metric("三角形2面积", f"{area2:.2f}")
    with col3:
        st.metric("面积比", f"{area1/area2:.2f}")
    with col4:
        st.metric("底边比", f"{base1/base2:.2f}")
    
    # 创建选项卡
    tab1, tab2, tab3 = st.tabs(["等高模型演示", "数学原理", "应用实例"])
    
    with tab1:
        show_height_model_demo(base1, base2, height)
    
    with tab2:
        show_mathematical_principle()
    
    with tab3:
        show_practical_examples()
```

#### 2. 等高模型演示
```python
def show_height_model_demo(base1, base2, height):
    """展示等高模型的演示。"""
    
    st.subheader("等高三角形面积对比")
    
    # 绘制对比图
    fig = draw_isosceles_triangles_comparison(base1, base2, height)
    st.pyplot(fig)
    
    # 数学验证
    st.subheader("数学验证")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.latex(f"S_1 = \frac{{{base1} \times {height}}}{{2}} = {base1 * height / 2:.2f}")
    
    with col2:
        st.latex(f"S_2 = \frac{{{base2} \times {height}}}{{2}} = {base2 * height / 2:.2f}")
    
    st.latex(f"\frac{{S_1}}{{S_2}} = \frac{{{base1 * height / 2:.2f}}}{{{base2 * height / 2:.2f}}} = \frac{{{base1}}}{{{base2}}} = {base1/base2:.2f}")
```

#### 3. 数学原理展示
```python
def show_mathematical_principle():
    """展示等高模型的数学原理。"""
    
    st.subheader("等高模型数学原理")
    
    # 原理说明
    principle = explain_height_model_principle()
    
    st.markdown(principle["principle"])
    
    # 公式展示
    st.latex(principle["formula"])
    
    # 应用场景
    st.subheader("应用场景")
    for app in principle["applications"]:
        st.write(f"• {app}")
```

#### 4. 应用实例
```python
def show_practical_examples():
    """展示等高模型的实际应用。"""
    
    st.subheader("实际应用案例")
    
    # 案例1：土地测量
    st.write("**案例1：土地面积计算**")
    st.info("""
    假设有一块三角形土地，已知高度为100米。通过测量发现底边长度为150米，
    现在需要在相同高度下划分出一块底边为50米的三角形区域。
    
    使用等高模型：
    - 原土地面积 = (150 × 100) / 2 = 7500平方米
    - 划分区域面积 = (50 × 100) / 2 = 2500平方米
    - 面积比 = 50/150 = 1/3
    """)
    
    # 案例2：建筑设计
    st.write("**案例2：屋顶设计**")
    st.info("""
    在设计屋顶时，两个不同大小的三角形屋顶具有相同的坡度（高度），
    大屋顶的底边为12米，小屋顶的底边为8米。
    
    使用等高模型：
    - 面积比 = 8/12 = 2/3
    - 如果大屋顶需要120平方米的材料，小屋顶需要80平方米
    """)
    
    # 案例3：地图测量
    st.write("**案例3：地图面积估算**")
    st.info("""
    在地图上测量两个三角形区域的面积，已知它们具有相同的地形高度。
    通过地图比例尺测量底边长度，可以快速估算面积比例。
    """)
```

## 数学原理

### 等高模型基本定理

#### 定理陈述
如果两个三角形具有相同的高度，那么它们的面积比等于底边长度的比。

#### 数学表达
设两个三角形的高均为h，底边分别为b₁和b₂，则：
$$\frac{S_1}{S_2} = \frac{b_1}{b_2}$$

#### 证明
根据三角形面积公式：
$$S_1 = \frac{1}{2}b_1h$$
$$S_2 = \frac{1}{2}b_2h$$

因此：
$$\frac{S_1}{S_2} = \frac{\frac{1}{2}b_1h}{\frac{1}{2}b_2h} = \frac{b_1}{b_2}$$

### 推广定理

#### 等高三角形性质
1. **面积比例性**: 等高三角形的面积与底边成正比
2. **高度不变性**: 改变底边长度不影响高度
3. **形状独立性**: 无论三角形形状如何，只要高相同，比例关系成立

#### 应用场景
1. **图形分割**: 将复杂图形分割为等高三角形
2. **比例计算**: 计算不同部分的面积比例
3. **测量应用**: 在无法直接测量面积时使用比例关系

## 性能优化

### 计算优化
- 使用NumPy进行高效的数学运算
- 缓存计算结果避免重复计算
- 使用向量化操作处理批量数据

### 可视化优化
- 使用合适的图形尺寸和比例
- 优化颜色方案提高可读性
- 减少不必要的图形重绘

## 测试用例

### 基本验证
```python
test_cases = [
    {"base1": 4, "base2": 6, "height": 3, 
     "expected_ratio": 4/6, "expected_areas": [6, 9]},
    {"base1": 5, "base2": 10, "height": 4, 
     "expected_ratio": 0.5, "expected_areas": [10, 20]},
    {"base1": 3, "base2": 3, "height": 5, 
     "expected_ratio": 1, "expected_areas": [7.5, 7.5]},
]
```

### 边界测试
```python
edge_cases = [
    {"base1": 0, "base2": 5, "height": 3, "expected_error": "底边不能为零"},
    {"base1": 2, "base2": 0, "height": 3, "expected_error": "底边不能为零"},
    {"base1": 2, "base2": 3, "height": 0, "expected_areas": [0, 0]},
]
```

## 扩展功能

### 未来改进
1. **任意三角形**: 支持任意形状的等高三角形
2. **3D扩展**: 扩展到三维空间中的等高模型
3. **动画演示**: 展示底边变化时的面积变化过程
4. **批量计算**: 支持多个三角形的批量处理

### 高级功能
1. **误差分析**: 分析测量误差对结果的影响
2. **单位换算**: 支持不同长度单位的换算
3. **图形识别**: 自动识别等高三角形
4. **报告生成**: 自动生成计算报告

## 相关文档

- [三角形分类页面实现文档](1_三角形分类_实现文档.md)
- [勾股定理页面实现文档](2_勾股定理_实现文档.md)
- [一半模型页面实现文档](4_一半模型_实现文档.md)
- [燕尾模型页面实现文档](5_燕尾模型_实现文档.md)

---

*文档创建时间：2024年*  
*最后更新：2024年*
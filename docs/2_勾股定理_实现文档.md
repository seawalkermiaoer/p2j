# 勾股定理页面实现文档

## 概述

本页面实现了勾股定理的交互式验证和证明功能。用户可以通过滑块调整直角三角形的两条直角边长度，实时观察斜边长度的计算结果，并通过图形化方式理解勾股定理的几何意义。

## 功能特性

### 核心功能
- **实时计算**: 根据直角边长度实时计算斜边长度
- **图形验证**: 通过正方形面积验证勾股定理
- **证明演示**: 提供多种勾股定理的图形化证明方法
- **历史背景**: 介绍勾股定理的历史和应用

### 交互功能
- 滑块调整直角边长度（范围：1-10）
- 实时显示计算结果
- 动态更新图形展示
- 支持图形导出

## 技术实现

### 文件结构
```
pages/2_勾股定理.py
├── 导入模块
├── 字体配置
├── 页面配置
├── 绘图函数
├── 勾股定理验证
├── 图形证明
└── 应用示例
```

### 核心算法

#### 1. 勾股定理计算
```python
def calculate_hypotenuse(a, b):
    """
    根据勾股定理计算直角三角形的斜边长度。
    
    勾股定理：c² = a² + b²
    
    Args:
        a: 直角边1的长度
        b: 直角边2的长度
    
    Returns:
        float: 斜边长度
    """
    return np.sqrt(a**2 + b**2)

def verify_pythagorean_theorem(a, b, c):
    """
    验证勾股定理是否成立。
    
    Args:
        a: 直角边1
        b: 直角边2
        c: 斜边
    
    Returns:
        dict: 验证结果和误差信息
    """
    calculated_c = calculate_hypotenuse(a, b)
    error = abs(c - calculated_c)
    is_valid = error < 1e-6
    
    return {
        "is_valid": is_valid,
        "calculated": calculated_c,
        "given": c,
        "error": error
    }
```

#### 2. 直角三角形绘制
```python
def draw_right_triangle(a, b, title="直角三角形"):
    """
    绘制直角三角形及其正方形。
    
    Args:
        a: 直角边1的长度
        b: 直角边2的长度
        title: 图形标题
    
    Returns:
        matplotlib.figure.Figure: 绘制的图形对象
    """
    fig, ax = plt.subplots(figsize=(10, 8))
    
    # 计算斜边
    c = calculate_hypotenuse(a, b)
    
    # 定义三角形顶点
    # 直角顶点在原点
    A = (0, 0)
    B = (a, 0)
    C = (0, b)
    
    # 绘制三角形
    triangle = Polygon([A, B, C], fill=True, alpha=0.7, color='lightblue')
    ax.add_patch(triangle)
    
    # 绘制直角标记
    right_angle_size = min(a, b) * 0.1
    right_angle = plt.Rectangle((0, 0), right_angle_size, right_angle_size, 
                               fill=False, edgecolor='red', linewidth=2)
    ax.add_patch(right_angle)
    
    # 绘制正方形
    # 边a的正方形
    square_a = plt.Rectangle((0, -a), a, a, fill=True, alpha=0.3, color='lightgreen')
    ax.add_patch(square_a)
    
    # 边b的正方形
    square_b = plt.Rectangle((-b, 0), b, b, fill=True, alpha=0.3, color='lightcoral')
    ax.add_patch(square_b)
    
    # 边c的正方形（斜边）
    # 计算斜边正方形的顶点
    c_square_vertices = calculate_c_square_vertices(a, b, c)
    square_c = Polygon(c_square_vertices, fill=True, alpha=0.3, color='lightyellow')
    ax.add_patch(square_c)
    
    # 添加标签
    ax.text(a/2, -a/2, f'a² = {a*a}', ha='center', va='center', fontsize=12, weight='bold')
    ax.text(-b/2, b/2, f'b² = {b*b}', ha='center', va='center', fontsize=12, weight='bold')
    
    # 计算c²正方形的中心
    c_center = np.mean(c_square_vertices, axis=0)
    ax.text(c_center[0], c_center[1], f'c² = {c*c:.1f}', 
            ha='center', va='center', fontsize=12, weight='bold')
    
    # 设置坐标轴
    margin = max(a, b) * 0.5
    ax.set_xlim(-b - margin, a + margin)
    ax.set_ylim(-a - margin, b + margin)
    ax.set_aspect('equal')
    ax.grid(True, alpha=0.3)
    ax.set_title(title, fontsize=16, pad=20)
    
    return fig

def calculate_c_square_vertices(a, b, c):
    """
    计算斜边正方形的顶点坐标。
    
    Args:
        a, b, c: 三角形的边长
    
    Returns:
        list: 正方形的四个顶点坐标
    """
    # 计算斜边的方向向量
    AB = np.array([a, 0])
    AC = np.array([0, b])
    BC = AC - AB
    
    # 计算垂直于BC的向量
    perpendicular = np.array([-BC[1], BC[0]])
    perpendicular = perpendicular / np.linalg.norm(perpendicular) * c
    
    # 计算正方形的四个顶点
    B = np.array([a, 0])
    C = np.array([0, b])
    
    # 从B点开始的正方形
    v1 = C - B
    v2 = perpendicular
    
    vertices = [
        B,
        B + v1,
        B + v1 + v2,
        B + v2
    ]
    
    return vertices
```

#### 3. 勾股定理证明

##### 几何证明法
```python
def draw_geometric_proof(a, b):
    """
    绘制勾股定理的几何证明。
    
    使用四个相同的直角三角形拼成一个大正方形，
    通过面积关系证明 a² + b² = c²。
    
    Args:
        a: 直角边1
        b: 直角边2
    
    Returns:
        matplotlib.figure.Figure: 证明图形
    """
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 8))
    
    c = calculate_hypotenuse(a, b)
    
    # 方法1：大正方形包含小正方形
    # 计算大正方形边长
    big_square_size = a + b
    
    # 绘制大正方形
    big_square = plt.Rectangle((0, 0), big_square_size, big_square_size, 
                               fill=False, edgecolor='black', linewidth=2)
    ax1.add_patch(big_square)
    
    # 绘制四个直角三角形
    triangles = [
        [(0, a), (a, a), (a, 0)],
        [(a, 0), (a+b, 0), (a+b, a)],
        [(a+b, a), (a+b, a+b), (b, a+b)],
        [(b, a+b), (0, a+b), (0, a)]
    ]
    
    colors = ['lightblue', 'lightcoral', 'lightgreen', 'lightyellow']
    for triangle, color in zip(triangles, colors):
        tri = Polygon(triangle, fill=True, alpha=0.7, color=color)
        ax1.add_patch(tri)
    
    # 绘制中间的小正方形
    small_square = plt.Rectangle((a, 0), b, a, fill=True, alpha=0.5, color='orange')
    ax1.add_patch(small_square)
    
    # 添加面积标注
    total_area = big_square_size**2
    triangle_area = 0.5 * a * b
    small_square_area = c**2
    
    ax1.text(big_square_size/2, -1, f'总面积 = {total_area}', 
             ha='center', fontsize=12)
    ax1.text(a + b/2, a/2, f'c² = {c**2:.1f}', 
             ha='center', va='center', fontsize=12, weight='bold')
    
    ax1.set_xlim(-1, big_square_size + 1)
    ax1.set_ylim(-2, big_square_size + 1)
    ax1.set_aspect('equal')
    ax1.set_title('勾股定理几何证明', fontsize=14)
    ax1.grid(True, alpha=0.3)
    
    # 方法2：代数推导
    ax2.text(0.5, 0.5, f'证明过程：\n\n'
                      f'大正方形面积 = (a + b)² = a² + 2ab + b²\n'
                      f'四个三角形面积 = 4 × (½ab) = 2ab\n'
                      f'中间小正方形面积 = c²\n\n'
                      f'因此：a² + 2ab + b² = 2ab + c²\n'
                      f'化简得：a² + b² = c²',
             ha='center', va='center', fontsize=14,
             bbox=dict(boxstyle="round,pad=0.5", facecolor="lightblue", alpha=0.8))
    ax2.set_xlim(0, 1)
    ax2.set_ylim(0, 1)
    ax2.axis('off')
    
    return fig
```

### 页面布局设计

#### 1. 主界面结构
```python
def main():
    """勾股定理页面的主函数。"""
    
    # 页面标题和介绍
    st.title("📐 勾股定理")
    st.markdown("探索直角三角形三边之间的关系：a² + b² = c²")
    
    # 创建三列布局用于滑块
    col1, col2, col3 = st.columns(3)
    
    with col1:
        a = st.slider("直角边 a", min_value=1.0, max_value=10.0, value=3.0, step=0.1)
    
    with col2:
        b = st.slider("直角边 b", min_value=1.0, max_value=10.0, value=4.0, step=0.1)
    
    with col3:
        c = calculate_hypotenuse(a, b)
        st.metric("斜边 c", f"{c:.2f}")
    
    # 显示计算过程
    st.latex(f"c = \sqrt{{{a}^2 + {b}^2} = \sqrt{{{a**2:.1f} + {b**2:.1f}}} = \sqrt{{{a**2 + b**2:.1f}}} = {c:.2f}")
    
    # 验证结果
    verification = verify_pythagorean_theorem(a, b, c)
    if verification["is_valid"]:
        st.success("✅ 勾股定理验证成功！")
    else:
        st.error("❌ 验证失败")
    
    # 创建选项卡
    tab1, tab2, tab3 = st.tabs(["图形验证", "几何证明", "应用示例"])
    
    with tab1:
        show_graphical_verification(a, b)
    
    with tab2:
        show_geometric_proof(a, b)
    
    with tab3:
        show_applications(a, b, c)
```

#### 2. 图形验证展示
```python
def show_graphical_verification(a, b):
    """展示勾股定理的图形验证。"""
    
    st.subheader("图形验证")
    st.write("通过正方形的面积关系验证勾股定理")
    
    # 绘制图形
    fig = draw_right_triangle(a, b)
    st.pyplot(fig)
    
    # 计算面积
    a_squared = a ** 2
    b_squared = b ** 2
    c_squared = (a ** 2) + (b ** 2)
    
    col1, col2, col3 = st.columns(3)
    with col1:
        st.metric("a²", f"{a_squared:.1f}")
    with col2:
        st.metric("b²", f"{b_squared:.1f}")
    with col3:
        st.metric("a² + b²", f"{c_squared:.1f}")
```

#### 3. 几何证明展示
```python
def show_geometric_proof(a, b):
    """展示勾股定理的几何证明。"""
    
    st.subheader("几何证明")
    st.write("使用四个相同的直角三角形拼成一个大正方形")
    
    fig = draw_geometric_proof(a, b)
    st.pyplot(fig)
```

#### 4. 应用示例
```python
def show_applications(a, b, c):
    """展示勾股定理的实际应用。"""
    
    st.subheader("实际应用")
    
    # 距离计算示例
    st.write("**距离计算**")
    st.latex(f"两点间的距离 = \sqrt{{({a})^2 + ({b})^2}} = {c:.2f}")
    
    # 高度计算示例
    st.write("**高度计算**")
    ladder_length = c
    distance_from_wall = a
    height = b
    
    st.info(f"一个长度为 {ladder_length:.1f} 米的梯子靠在墙上，"
            f"底部距离墙 {distance_from_wall:.1f} 米，"
            f"那么梯子顶端的高度为 {height:.1f} 米")
    
    # 导航计算示例
    st.write("**导航应用**")
    east_distance = a
    north_distance = b
    direct_distance = c
    
    st.info(f"向东走了 {east_distance:.1f} 公里，向北走了 {north_distance:.1f} 公里，"
            f"那么直线距离起点为 {direct_distance:.1f} 公里")
```

## 数学原理

### 勾股定理
对于任意直角三角形，设两条直角边长为a和b，斜边长为c，则有：
$$a^2 + b^2 = c^2$$

### 证明方法

#### 1. 几何证明
通过四个相同的直角三角形拼成一个大正方形，利用面积关系证明：
- 大正方形面积：(a + b)²
- 四个三角形面积：4 × (½ab) = 2ab
- 中间小正方形面积：c²
- 因此：(a + b)² = 2ab + c²
- 化简得：a² + b² = c²

#### 2. 代数证明
使用相似三角形原理：
- 设直角三角形ABC，直角在C
- 从C向斜边AB作垂线CD
- 三角形ACD ~ 三角形ABC ~ 三角形CBD
- 根据相似比可得：a² + b² = c²

### 逆定理
如果三角形的三边满足a² + b² = c²，那么这个三角形一定是直角三角形，且直角对着最长边c。

## 性能优化

### 计算优化
- 使用NumPy进行高效的数学运算
- 缓存计算结果避免重复计算
- 使用向量化操作处理批量数据

### 可视化优化
- 使用合适的图形尺寸和比例
- 优化颜色方案提高可读性
- 减少不必要的图形重绘

## 测试用例

### 基本验证
```python
test_cases = [
    {"a": 3, "b": 4, "expected_c": 5},
    {"a": 5, "b": 12, "expected_c": 13},
    {"a": 8, "b": 15, "expected_c": 17},
    {"a": 7, "b": 24, "expected_c": 25},
    {"a": 1, "b": 1, "expected_c": np.sqrt(2)},
]
```

### 边界测试
```python
edge_cases = [
    {"a": 0, "b": 0, "expected_error": "边长不能为零"},
    {"a": -1, "b": 1, "expected_error": "边长必须为正数"},
    {"a": 1e-10, "b": 1e-10, "expected_c": np.sqrt(2) * 1e-10},
]
```

## 扩展功能

### 未来改进
1. **三维勾股定理**: 扩展到三维空间中的距离计算
2. **三角函数**: 结合三角函数展示更多数学关系
3. **动画演示**: 添加动态的图形证明过程
4. **实际案例**: 增加更多现实生活中的应用案例

### 高级功能
1. **参数方程**: 支持参数化的直角三角形
2. **误差分析**: 分析数值计算的精度
3. **单位换算**: 支持不同长度单位的换算
4. **批量计算**: 支持多个三角形的同时计算

## 相关文档

- [三角形分类页面实现文档](1_三角形分类_实现文档.md)
- [等高模型页面实现文档](3_等高模型_实现文档.md)
- [一半模型页面实现文档](4_一半模型_实现文档.md)
- [燕尾模型页面实现文档](5_燕尾模型_实现文档.md)

---

*文档创建时间：2024年*  
*最后更新：2024年*
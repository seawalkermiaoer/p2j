# 7_相似模型 实现文档

## 1. 概述

“相似模型”是几何学习中的一个核心概念，它描述了形状相同但大小不同的图形之间的关系。本模块旨在通过一个名为“神奇的缩放魔法屋”的交互式应用，帮助小学生直观地理解相似三角形的定义、性质和基本应用。

应用通过一个“魔法缩放尺”滑块，让学生可以动态地“缩放”一个三角形，并实时观察其边长和角度的变化，从而深刻理解“角不变，边成比例”这一核心原理。

## 2. 功能特色

- **故事化引导**：以《“复制”和“缩放”的魔法》为主题，将数学概念包装成有趣的故事，降低学习门槛。
- **实时交互**：用户通过拖动滑块，可以实时看到一个三角形如何被缩放成另一个相似的三角形，反馈直观。
- **数据驱动**：实时计算并显示原始三角形和缩放后三角形的边长与角度，用具体数据验证“角不变，边成比例”的性质。
- **动态可视化**：使用 Matplotlib 动态绘制两个三角形，图形会随着用户的操作平滑变化。
- **理论与应用结合**：在解释了数学原理后，引入了“泰勒斯测量金字塔”的经典故事，展示了相似模型的实际应用价值。

## 3. 技术实现

### 3.1. 文件结构

- **页面实现**: `pages/7_相似模型.py`
- **实现文档**: `docs/7_相似模型_实现文档.md`

### 3.2. 核心算法与逻辑

#### a. 相似变换的计算

相似变换的核心在于将一个图形的所有顶点坐标同时乘以一个相同的缩放因子 `k`。这种方法比分别计算边长更简单、更高效。

- **原始三角形顶点**：在代码中定义一个固定的 `numpy` 数组 `original_vertices`，例如一个边长为 3, 4, 5 的直角三角形 `[[0, 0], [4, 0], [4, 3]]`。
- **缩放倍数**：通过 `st.slider` 获取用户设定的缩放倍数 `scale_factor`。
- **魔法三角形顶点**：通过简单的矩阵乘法计算新的顶点坐标：`scaled_vertices = original_vertices * scale_factor`。

#### b. 边长和角度的计算

为了向用户展示数据，应用中包含了两个核心计算函数：

- `calculate_side_lengths(vertices)`: 接收一个顶点数组，利用 `np.linalg.norm` 计算两点间的距离，从而得到三角形的三条边长。
- `calculate_angles(sides)`: 接收三条边长，利用余弦定理 `np.arccos((a² + b² - c²) / (2ab))` 计算出每个角的弧度，再用 `np.degrees` 转换为角度制。

通过对原始三角形和魔法三角形分别调用这两个函数，可以清晰地对比出“边成比例，角相等”的特性。

### 3.3. 可视化实现

- **布局**: 使用 `st.columns` 创建左右分栏，左侧为控制区和数据显示区，右侧为图形展示区。
- **绘图**: 
  - 使用 `matplotlib.pyplot` 创建一个 `figure` 和 `axes` 对象。
  - 使用 `matplotlib.patches.Polygon` 类来创建两个三角形的面片，并设置不同的颜色（如天蓝色和三文鱼色）以作区分。
  - 使用 `ax.plot` 绘制三角形的轮廓和顶点。
  - 通过 `ax.text` 在顶点旁边标注标签（如 A, B, C 和 A', B', C'）。
- **动态更新**: 每当滑块的值发生变化，Streamlit 会重新执行整个脚本。此时，会基于新的 `scale_factor` 计算出新的顶点，并调用绘图函数重新生成一幅新的图形，然后通过 `st.pyplot(fig)` 显示在页面上，从而实现动态效果。
- **坐标轴自适应**：为了确保缩放后的图形能完整显示，绘图函数会根据两个三角形的所有顶点坐标动态计算并设置 `xlim` 和 `ylim`，保证了良好的视觉体验。

## 4. 教育内容设计

本模块的教育内容严格遵循了用户提供的“故事版说明书”，旨在让小学生“知其然，并知其所以然”。

- **引入 (What)**: 用“玩具车与真车”的比喻，生动解释了什么是“相似”。
- **原理 (How)**: 通过“大角”和“小角”的例子，提出了判断相似的两个秘诀：“角都相等”和“边成比例”。
- **交互验证 (Verification)**: “神奇的缩放魔法屋”应用本身就是对原理的最佳验证。学生通过亲手操作，可以自己“发现”这个规律。
- **应用 (Why)**: 引入泰勒斯测量金字塔的故事，将抽象的数学知识与解决实际问题联系起来，激发学生的学习兴趣和探索欲。

## 5. 技术优化与细节

- **字体支持**: 继承了项目统一的 `utils.fonts.setup_custom_font()` 设置，确保中英文混合显示正常。
- **代码风格**: 遵循 Google Python 风格指南，代码结构清晰，注释充分。
- **用户体验**: 滑块设置了合理的范围（0.5到5.0）和步长（0.1），使得缩放体验平滑。信息展示区使用了 `st.info` 来突出“魔法揭秘”的核心结论，引导学生思考。
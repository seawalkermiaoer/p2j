# 三角形分类页面实现文档

## 概述

本页面实现了三角形的分类功能，支持按角度和按边长两种分类方式。通过交互式界面和可视化图形，帮助用户理解不同类型三角形的特征和分类标准。

## 功能特性

### 核心功能
- **按角分类**: 锐角三角形、直角三角形、钝角三角形
- **按边分类**: 等边三角形、等腰三角形、不等边三角形
- **动态可视化**: 根据三角形顶点坐标实时绘制图形
- **分类验证**: 自动判断三角形类型并提供详细说明

### 交互功能
- 动态展示不同类型三角形的示例
- 鼠标悬停显示角度和边长信息
- 支持图形缩放和平移
- 一键导出图形为图片

## 技术实现

### 文件结构
```
pages/1_三角形分类.py
├── 导入模块
├── 字体配置
├── 页面配置
├── 绘图函数
├── 按角分类模块
├── 按边分类模块
└── 补充说明
```

### 核心算法

#### 1. 三角形顶点坐标计算
```python
def calculate_triangle_vertices(a, b, c):
    """
    根据三边长度计算三角形顶点坐标。
    
    算法原理：
    1. 将边a放在x轴上，第一个顶点在原点(0,0)
    2. 第二个顶点在(a,0)
    3. 使用余弦定理计算第三个顶点坐标
    
    Args:
        a: 边a的长度
        b: 边b的长度
        c: 边c的长度
    
    Returns:
        list: 三个顶点的坐标 [(x1,y1), (x2,y2), (x3,y3)]
    """
    # 使用海伦公式验证三角形有效性
    if a + b <= c or a + c <= b or b + c <= a:
        return None
    
    # 顶点A在原点
    A = (0, 0)
    
    # 顶点B在x轴上
    B = (a, 0)
    
    # 使用余弦定理计算顶点C的坐标
    # cos(B) = (a² + c² - b²) / (2ac)
    cos_B = (a**2 + c**2 - b**2) / (2 * a * c)
    sin_B = np.sqrt(1 - cos_B**2)
    
    C = (c * cos_B, c * sin_B)
    
    return [A, B, C]
```

#### 2. 角度计算
```python
def calculate_angles(a, b, c):
    """
    计算三角形的三个内角。
    
    使用余弦定理：
    cos(A) = (b² + c² - a²) / (2bc)
    cos(B) = (a² + c² - b²) / (2ac)
    cos(C) = (a² + b² - c²) / (2ab)
    
    Args:
        a, b, c: 三角形的三边长度
    
    Returns:
        dict: 三个角的度数 {'A': angle_A, 'B': angle_B, 'C': angle_C}
    """
    # 计算角的余弦值
    cos_A = (b**2 + c**2 - a**2) / (2 * b * c)
    cos_B = (a**2 + c**2 - b**2) / (2 * a * c)
    cos_C = (a**2 + b**2 - c**2) / (2 * a * b)
    
    # 转换为角度
    angle_A = np.degrees(np.arccos(cos_A))
    angle_B = np.degrees(np.arccos(cos_B))
    angle_C = np.degrees(np.arccos(cos_C))
    
    return {'A': angle_A, 'B': angle_B, 'C': angle_C}
```

#### 3. 分类算法

##### 按角分类
```python
def classify_by_angles(angles):
    """
    根据角度对三角形进行分类。
    
    分类标准：
    - 锐角三角形：三个角都小于90度
    - 直角三角形：有一个角等于90度
    - 钝角三角形：有一个角大于90度
    
    Args:
        angles: 三个角的度数字典
    
    Returns:
        str: 三角形类型
    """
    max_angle = max(angles.values())
    
    if abs(max_angle - 90) < 1e-6:  # 考虑浮点误差
        return "直角三角形"
    elif max_angle > 90:
        return "钝角三角形"
    else:
        return "锐角三角形"
```

##### 按边分类
```python
def classify_by_sides(a, b, c):
    """
    根据边长对三角形进行分类。
    
    分类标准：
    - 等边三角形：三条边相等
    - 等腰三角形：两条边相等
    - 不等边三角形：三条边都不相等
    
    Args:
        a, b, c: 三角形的三边长度
    
    Returns:
        str: 三角形类型
    """
    if abs(a - b) < 1e-6 and abs(b - c) < 1e-6:
        return "等边三角形"
    elif abs(a - b) < 1e-6 or abs(b - c) < 1e-6 or abs(a - c) < 1e-6:
        return "等腰三角形"
    else:
        return "不等边三角形"
```

### 可视化实现

#### 1. 绘图函数
```python
def draw_triangle(vertices, title="三角形", show_labels=True):
    """
    绘制三角形及其相关信息。
    
    Args:
        vertices: 三角形顶点坐标列表
        title: 图形标题
        show_labels: 是否显示标签
    
    Returns:
        matplotlib.figure.Figure: 绘制的图形对象
    """
    fig, ax = plt.subplots(figsize=(8, 6))
    
    # 绘制三角形
    triangle = Polygon(vertices, fill=True, alpha=0.3, color='lightblue')
    ax.add_patch(triangle)
    
    # 绘制顶点
    vertices = np.array(vertices)
    ax.plot(vertices[:, 0], vertices[:, 1], 'ro', markersize=8)
    
    # 添加顶点标签
    if show_labels:
        labels = ['A', 'B', 'C']
        for i, (x, y) in enumerate(vertices):
            ax.annotate(labels[i], (x, y), xytext=(5, 5), 
                       textcoords='offset points', fontsize=12)
    
    # 设置坐标轴
    ax.set_xlim(min(vertices[:, 0]) - 1, max(vertices[:, 0]) + 1)
    ax.set_ylim(min(vertices[:, 1]) - 1, max(vertices[:, 1]) + 1)
    ax.set_aspect('equal')
    ax.grid(True, alpha=0.3)
    ax.set_title(title, fontsize=14, pad=20)
    
    return fig
```

#### 2. 角度标注
```python
def add_angle_labels(ax, vertices, angles):
    """
    在三角形图形上添加角度标签。
    
    Args:
        ax: matplotlib 坐标轴对象
        vertices: 三角形顶点坐标
        angles: 角度字典
    """
    vertices = np.array(vertices)
    
    # 计算角度标签位置（三角形的重心附近）
    for i, angle_name in enumerate(['A', 'B', 'C']):
        # 获取当前顶点和相邻顶点
        current = vertices[i]
        prev = vertices[(i - 1) % 3]
        next_ = vertices[(i + 1) % 3]
        
        # 计算角度位置（稍微偏离顶点）
        angle_pos = current + 0.2 * (prev - current) + 0.2 * (next_ - current)
        
        # 添加角度标签
        ax.text(angle_pos[0], angle_pos[1], 
                f'{angle_name}: {angles[angle_name]:.1f}°',
                fontsize=10, ha='center', va='center',
                bbox=dict(boxstyle="round,pad=0.3", facecolor="yellow", alpha=0.7))
```

### 页面布局设计

#### 1. 主页面结构
```python
def main():
    """三角形分类页面的主函数。"""
    
    # 页面标题和介绍
    st.title("🔺 三角形分类")
    st.markdown("学习如何根据角度和边长对三角形进行分类")
    
    # 创建两列布局
    col1, col2 = st.columns(2)
    
    with col1:
        st.header("按角分类")
        # 锐角三角形示例
        show_acute_triangle()
        
        # 直角三角形示例
        show_right_triangle()
        
        # 钝角三角形示例
        show_obtuse_triangle()
    
    with col2:
        st.header("按边分类")
        # 等边三角形示例
        show_equilateral_triangle()
        
        # 等腰三角形示例
        show_isosceles_triangle()
        
        # 不等边三角形示例
        show_scalene_triangle()
```

#### 2. 示例展示函数
```python
def show_acute_triangle():
    """展示锐角三角形的示例。"""
    
    # 定义锐角三角形的顶点
    vertices = [(0, 0), (4, 0), (2, 3)]
    
    # 计算边长
    a = np.sqrt((vertices[1][0] - vertices[2][0])**2 + 
                (vertices[1][1] - vertices[2][1])**2)
    b = np.sqrt((vertices[0][0] - vertices[2][0])**2 + 
                (vertices[0][1] - vertices[2][1])**2)
    c = np.sqrt((vertices[0][0] - vertices[1][0])**2 + 
                (vertices[0][1] - vertices[1][1])**2)
    
    # 计算角度
    angles = calculate_angles(a, b, c)
    
    # 绘制图形
    fig = draw_triangle(vertices, "锐角三角形")
    
    # 添加分类说明
    st.pyplot(fig)
    st.info("锐角三角形：三个内角都小于90度")
```

## 数学原理

### 三角形分类标准

#### 按角分类
1. **锐角三角形**: 三个内角都小于90°
   - 性质：外心在三角形内部
   - 示例：等边三角形（每个角都是60°）

2. **直角三角形**: 有一个内角等于90°
   - 性质：外心在斜边的中点
   - 勾股定理：a² + b² = c²

3. **钝角三角形**: 有一个内角大于90°
   - 性质：外心在三角形外部
   - 最长边对着钝角

#### 按边分类
1. **等边三角形**: 三条边相等
   - 性质：三个角都是60°
   - 面积公式：(√3/4)a²

2. **等腰三角形**: 两条边相等
   - 性质：等边对等角
   - 对称轴：顶角的平分线

3. **不等边三角形**: 三条边都不相等
   - 性质：三个角都不相等
   - 海伦公式计算面积

### 验证算法

#### 三角形有效性检查
```python
def is_valid_triangle(a, b, c):
    """
    验证三边是否能构成三角形。
    
    三角形不等式：
    - a + b > c
    - a + c > b
    - b + c > a
    
    Args:
        a, b, c: 三条边的长度
    
    Returns:
        bool: 是否能构成三角形
    """
    return (a + b > c) and (a + c > b) and (b + c > a)
```

#### 多重分类验证
```python
def classify_triangle(a, b, c):
    """
    综合分类三角形，同时给出按角和按边的分类结果。
    
    Args:
        a, b, c: 三角形的三边长度
    
    Returns:
        dict: 包含角度分类和边长分类的结果
    """
    if not is_valid_triangle(a, b, c):
        return {"error": "无法构成三角形"}
    
    # 计算角度
    angles = calculate_angles(a, b, c)
    
    # 分类
    angle_type = classify_by_angles(angles)
    side_type = classify_by_sides(a, b, c)
    
    return {
        "angle_classification": angle_type,
        "side_classification": side_type,
        "angles": angles,
        "sides": {"a": a, "b": b, "c": c}
    }
```

## 性能优化

### 计算优化
- 使用NumPy进行向量化计算
- 缓存重复计算结果
- 避免浮点数精度问题

### 可视化优化
- 使用合理的图形尺寸和分辨率
- 优化颜色方案以提高可读性
- 减少不必要的图形元素

## 测试用例

### 边界测试
```python
test_cases = [
    # 等边三角形
    {"a": 3, "b": 3, "c": 3, "expected": {"angle": "锐角", "side": "等边"}},
    
    # 直角三角形
    {"a": 3, "b": 4, "c": 5, "expected": {"angle": "直角", "side": "不等边"}},
    
    # 等腰直角三角形
    {"a": 1, "b": 1, "c": np.sqrt(2), "expected": {"angle": "直角", "side": "等腰"}},
    
    # 钝角三角形
    {"a": 2, "b": 3, "c": 4, "expected": {"angle": "钝角", "side": "不等边"}},
    
    # 退化三角形
    {"a": 1, "b": 2, "c": 3, "expected": {"error": "无法构成三角形"}},
]
```

## 扩展功能

### 未来改进
1. **交互式绘制**: 允许用户通过鼠标绘制三角形
2. **动态演示**: 展示三角形变形过程中的分类变化
3. **3D可视化**: 支持三维空间中的三角形展示
4. **导出功能**: 支持将结果导出为PDF或图片

### 教学功能
1. **分步讲解**: 逐步展示分类判断过程
2. **练习题**: 随机生成三角形让用户分类
3. **成绩跟踪**: 记录用户的分类准确率
4. **难度分级**: 根据三角形复杂度调整难度

## 相关文档

- [勾股定理页面实现文档](2_勾股定理_实现文档.md)
- [等高模型页面实现文档](3_等高模型_实现文档.md)
- [一半模型页面实现文档](4_一半模型_实现文档.md)
- [燕尾模型页面实现文档](5_燕尾模型_实现文档.md)

---

*文档创建时间：2024年*  
*最后更新：2024年*
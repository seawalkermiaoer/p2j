# “蝴蝶翅膀的面积计算器”实现文档（升级版）

## 1. 概述

本文档详细介绍了“蝴蝶翅膀的面积计算器”Streamlit应用的实现过程。与初版不同，此升级版应用旨在揭示“蝴蝶模型”在**任意四边形**中的普遍规律，即“相对翅膀面积之积相等”的核心定理。应用的核心功能不再是图形的动态变化，而是成为一个强大的**数学规律验证和计算工具**。

## 2. 功能特色

- **通用模型**：应用基于任意四边形构建的蝴蝶模型，摆脱了初版中“平行边”（梯形）的限制，教学意义更广泛。
- **未知面积计算**：用户可以输入四个“翅膀”（S1, S2, S3, S4）中的任意三个的面积，应用能根据蝴蝶模型的乘积定律自动计算出第四个未知面积。
- **规律的实时验证**：计算完成后，应用会以清晰的数学公式和计算步骤，展示以下两个核心规律的验证过程：
  1.  **乘积相等验证**：`S1 × S3 = S2 × S4`
  2.  **比例相等验证**：`S1 / S2 = S4 / S3` 和 `S1 / S4 = S2 / S3`
- **清晰的界面布局**：采用左右分栏布局，左侧为静态的、标注清晰的蝴蝶模型示意图，右侧为用户输入和计算结果展示区，一目了然。
- **友好的用户引导**：通过提示信息，引导用户将待计算的面积设为0，并处理了不规范输入（如多于或少于一个未知数）的边界情况。

## 3. 技术实现

### 3.1. 核心算法

应用的核心是“蝴蝶模型面积乘积定理”的代数运算。

- **核心公式**：
  `S1 × S3 = S2 × S4`

- **计算逻辑**：
  当用户点击“开始计算”按钮后，程序首先检查四个输入框中是否**有且仅有一个**的值为0。这个值为0的输入框即代表用户想要计算的未知面积。

  根据这个逻辑，可以推导出计算任意一个未知面积的公式。例如，如果`S4`是未知的（`s4 == 0`），则：
  ```python
  s4 = (s1 * s3) / s2
  ```
  程序会根据未知项的不同，动态选择对应的计算公式。

### 3.2. 界面实现

- **布局**：使用`st.columns`创建左右布局。
- **示意图**：左侧的示意图使用`matplotlib`绘制。与初版不同，这是一个**静态图片**，仅用于展示S1, S2, S3, S4的相对位置，因为此版应用的重点是代数验证而非几何动态变化。
- **输入与交互**：
  - 使用`st.number_input`创建四个面积输入框。
  - 使用`st.button`触发计算事件。
  - 对用户的输入进行校验，通过`st.error`向用户反馈输入错误。
- **结果展示**：
  - 使用`st.success`报告计算出的未知面积。
  - 使用`st.latex`和`st.write`的组合，清晰地展示数学公式和每一步的代入计算结果，让学生能直观地看到定理的成立。
  - 使用`numpy.isclose()`来判断浮点数是否相等，以避免精度问题带来的判断失误。

## 4. 教育内容设计

- **从特例到通例**：本次升级完成了从“梯形蝴蝶模型”（相似）到“任意四边形蝴蝶模型”（面积关系）的认知飞跃，帮助学生建立更普遍的数学思想。
- **变被动为主动**：应用鼓励学生成为“实验者”。他们可以随意设置面积数值，通过自己的“实验”来反复验证这个神奇的数学规律，从而达到深刻理解和记忆的目的。
- **强化代数思想**：应用的核心是解方程（例如 `S4 = (S1 * S3) / S2`），这让学生在学习几何的同时，也锻炼了代数思维和方程求解能力。
- **清晰的验证步骤**：应用不仅给出最终答案，更重要的是展示了“魔法”生效的全过程，让学生知其然，更知其所以然。
# æŠ€æœ¯æ¶æ„å’Œéƒ¨ç½²æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºStreamlitçš„å‡ ä½•å­¦ä¹ å¹³å°ï¼Œä¸“æ³¨äºä¸‰è§’å½¢ç›¸å…³çŸ¥è¯†çš„äº¤äº’å¼å­¦ä¹ ã€‚é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼ŒåŒ…å«äº”ä¸ªä¸»è¦åŠŸèƒ½æ¨¡å—ï¼šä¸‰è§’å½¢åˆ†ç±»ã€å‹¾è‚¡å®šç†ã€ç­‰é«˜æ¨¡å‹ã€ä¸€åŠæ¨¡å‹å’Œç‡•å°¾æ¨¡å‹ã€‚

## æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„

```
å‡ ä½•å­¦ä¹ å¹³å°
â”œâ”€â”€ å‰ç«¯å±‚
â”‚   â”œâ”€â”€ Streamlitåº”ç”¨æ¡†æ¶
â”‚   â”œâ”€â”€ äº¤äº’å¼å¯è§†åŒ–
â”‚   â””â”€â”€ å“åº”å¼ç•Œé¢
â”œâ”€â”€ ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ å‡ ä½•è®¡ç®—å¼•æ“
â”‚   â”œâ”€â”€ å›¾å½¢æ¸²æŸ“å¼•æ“
â”‚   â””â”€â”€ æ•°æ®éªŒè¯æ¨¡å—
â”œâ”€â”€ æ•°æ®å±‚
â”‚   â”œâ”€â”€ æ•°å­¦ç®—æ³•åº“
â”‚   â”œâ”€â”€ å›¾å½¢é…ç½®æ•°æ®
â”‚   â””â”€â”€ ç”¨æˆ·äº¤äº’æ•°æ®
â””â”€â”€ åŸºç¡€è®¾æ–½å±‚
    â”œâ”€â”€ Pythonè¿è¡Œæ—¶
    â”œâ”€â”€ ä¾èµ–ç®¡ç†
    â””â”€â”€ éƒ¨ç½²ç¯å¢ƒ
```

### æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæŠ€æœ¯
- **Python 3.8+**: ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **Streamlit 1.28+**: Webåº”ç”¨æ¡†æ¶
- **NumPy 1.23+**: æ•°å€¼è®¡ç®—åº“
- **Matplotlib 3.6+**: å›¾å½¢ç»˜åˆ¶åº“

#### å¼€å‘å·¥å…·
- **Google Python Style Guide**: ä»£ç è§„èŒƒ
- **Git**: ç‰ˆæœ¬æ§åˆ¶
- **VS Code**: å¼€å‘ç¯å¢ƒ
- **pip**: åŒ…ç®¡ç†å·¥å…·

### æ¨¡å—æ¶æ„

#### 1. åº”ç”¨å…¥å£
```python
# main.py - åº”ç”¨ä¸»å…¥å£
import streamlit as st
from utils.fonts import setup_custom_font
from pages import *

def main():
    """åº”ç”¨ä¸»å‡½æ•°ã€‚"""
    setup_custom_font()
    st.set_page_config(
        page_title="å‡ ä½•å­¦ä¹ å¹³å°",
        page_icon="ğŸ”º",
        layout="wide"
    )
    
    # é¡µé¢è·¯ç”±
    pages = {
        "ä¸‰è§’å½¢åˆ†ç±»": triangle_classification,
        "å‹¾è‚¡å®šç†": pythagorean_theorem,
        "ç­‰é«˜æ¨¡å‹": equal_height_model,
        "ä¸€åŠæ¨¡å‹": half_model,
        "ç‡•å°¾æ¨¡å‹": yanwei_model
    }
    
    # é¡µé¢é€‰æ‹©
    selected_page = st.sidebar.selectbox("é€‰æ‹©åŠŸèƒ½", list(pages.keys()))
    pages[selected_page]()
```

#### 2. å­—ä½“ç®¡ç†æ¨¡å—
```python
# utils/fonts.py - å­—ä½“ç®¡ç†
import matplotlib.pyplot as plt
from pathlib import Path

def setup_custom_font(font_path: str = None) -> bool:
    """
    è®¾ç½®è‡ªå®šä¹‰å­—ä½“ã€‚
    
    Args:
        font_path: å­—ä½“æ–‡ä»¶è·¯å¾„
    
    Returns:
        bool: è®¾ç½®æ˜¯å¦æˆåŠŸ
    """
    try:
        if font_path and Path(font_path).exists():
            plt.rcParams['font.family'] = font_path
        else:
            plt.rcParams['font.family'] = ['SimHei', 'DejaVu Sans']
        return True
    except Exception as e:
        print(f"å­—ä½“è®¾ç½®å¤±è´¥: {e}")
        return False
```

#### 3. é¡µé¢æ¨¡å—æ¶æ„
æ¯ä¸ªé¡µé¢æ¨¡å—éµå¾ªç»Ÿä¸€çš„æ¶æ„æ¨¡å¼ï¼š

```python
# é¡µé¢æ¨¡å—æ¨¡æ¿
import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
from utils.fonts import setup_custom_font

def render_header():
    """æ¸²æŸ“é¡µé¢å¤´éƒ¨ã€‚"""
    st.title("é¡µé¢æ ‡é¢˜")
    st.markdown("é¡µé¢æè¿°")

def render_controls():
    """æ¸²æŸ“æ§åˆ¶é¢æ¿ã€‚"""
    st.sidebar.header("å‚æ•°è°ƒæ•´")
    # å‚æ•°æ§ä»¶

def render_visualization():
    """æ¸²æŸ“å¯è§†åŒ–å†…å®¹ã€‚"""
    # å›¾å½¢ç»˜åˆ¶é€»è¾‘

def render_explanation():
    """æ¸²æŸ“åŸç†è¯´æ˜ã€‚"""
    # æ•°å­¦åŸç†å±•ç¤º

def main():
    """é¡µé¢ä¸»å‡½æ•°ã€‚"""
    setup_custom_font()
    render_header()
    render_controls()
    render_visualization()
    render_explanation()

if __name__ == "__main__":
    main()
```

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ

#### æœ¬åœ°å¼€å‘
```bash
# ç¯å¢ƒå‡†å¤‡
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
pip install -r requirements.txt

# å¯åŠ¨åº”ç”¨
streamlit run main.py
```

#### å¼€å‘å·¥å…·é…ç½®
```json
// .vscode/settings.json
{
    "python.defaultInterpreterPath": "./venv/bin/python",
    "python.linting.enabled": true,
    "python.linting.pylintEnabled": true,
    "python.formatting.provider": "black",
    "editor.formatOnSave": true
}
```

### ç”Ÿäº§ç¯å¢ƒ

#### Dockeréƒ¨ç½²
```dockerfile
# Dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8501

CMD ["streamlit", "run", "main.py", "--server.port=8501", "--server.address=0.0.0.0"]
```

#### Docker Composeé…ç½®
```yaml
# docker-compose.yml
version: '3.8'

services:
  geometry-app:
    build: .
    ports:
      - "8501:8501"
    environment:
      - STREAMLIT_SERVER_PORT=8501
      - STREAMLIT_SERVER_ADDRESS=0.0.0.0
    volumes:
      - ./data:/app/data
    restart: unless-stopped
```

#### äº‘æœåŠ¡éƒ¨ç½²

##### 1. Herokuéƒ¨ç½²
```yaml
# app.yaml (Heroku)
runtime: python3.9

build:
  docker:
    web: Dockerfile

run:
  web: streamlit run main.py --server.port=$PORT --server.address=0.0.0.0
```

##### 2. AWS EC2éƒ¨ç½²
```bash
# EC2éƒ¨ç½²è„šæœ¬
#!/bin/bash
sudo apt-get update
sudo apt-get install -y python3-pip
pip3 install -r requirements.txt
nohup streamlit run main.py --server.port=80 --server.address=0.0.0.0 &
```

##### 3. Google Cloud Run
```yaml
# cloudbuild.yaml
steps:
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/$PROJECT_ID/geometry-app', '.']
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/$PROJECT_ID/geometry-app']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['run', 'deploy', 'geometry-app', '--image', 'gcr.io/$PROJECT_ID/geometry-app', '--platform', 'managed']
```

## æ€§èƒ½ä¼˜åŒ–

### è®¡ç®—ä¼˜åŒ–

#### 1. ç¼“å­˜ç­–ç•¥
```python
# utils/cache.py
import functools
import streamlit as st

@st.cache_data
def calculate_triangle_area(a, b, c):
    """ç¼“å­˜ä¸‰è§’å½¢é¢ç§¯è®¡ç®—ã€‚"""
    s = (a + b + c) / 2
    return (s * (s - a) * (s - b) * (s - c)) ** 0.5

@st.cache_resource
def get_matplotlib_figure():
    """ç¼“å­˜å›¾å½¢å¯¹è±¡ã€‚"""
    return plt.figure(figsize=(10, 6))
```

#### 2. å¹¶è¡Œè®¡ç®—
```python
# utils/parallel.py
import concurrent.futures
import numpy as np

def batch_calculate_areas(triangles):
    """æ‰¹é‡è®¡ç®—ä¸‰è§’å½¢é¢ç§¯ã€‚"""
    with concurrent.futures.ThreadPoolExecutor() as executor:
        results = executor.map(calculate_triangle_area, triangles)
    return list(results)
```

### å†…å­˜ä¼˜åŒ–

#### 1. å›¾å½¢å†…å­˜ç®¡ç†
```python
# utils/memory.py
import gc
import matplotlib.pyplot as plt

def cleanup_matplotlib():
    """æ¸…ç†matplotlibå†…å­˜ã€‚"""
    plt.clf()
    plt.cla()
    plt.close('all')
    gc.collect()
```

#### 2. æ•°æ®å‹ç¼©
```python
# utils/compression.py
import numpy as np

def compress_coordinates(coords):
    """å‹ç¼©åæ ‡æ•°æ®ã€‚"""
    return np.round(coords, decimals=2)
```

### ç½‘ç»œä¼˜åŒ–

#### 1. é™æ€èµ„æºä¼˜åŒ–
```python
# utils/assets.py
def optimize_image(image_path):
    """ä¼˜åŒ–å›¾åƒæ–‡ä»¶ã€‚"""
    # ä½¿ç”¨PILä¼˜åŒ–å›¾åƒå¤§å°
    from PIL import Image
    with Image.open(image_path) as img:
        img.save(image_path, optimize=True, quality=85)
```

#### 2. CDNé…ç½®
```yaml
# streamlit_config.toml
[server]
enableCORS = false
enableXsrfProtection = false

[browser]
gatherUsageStats = false
```

## ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç›‘æ§

#### 1. æ€§èƒ½ç›‘æ§
```python
# utils/monitoring.py
import time
import streamlit as st

def monitor_performance(func):
    """æ€§èƒ½ç›‘æ§è£…é¥°å™¨ã€‚"""
    def wrapper(*args, **kwargs):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        
        st.sidebar.text(f"{func.__name__}è€—æ—¶: {end_time - start_time:.2f}s")
        return result
    return wrapper
```

#### 2. é”™è¯¯ç›‘æ§
```python
# utils/error_handler.py
import streamlit as st
import traceback

def handle_exception(func):
    """å¼‚å¸¸å¤„ç†è£…é¥°å™¨ã€‚"""
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            st.error(f"å‘ç”Ÿé”™è¯¯: {str(e)}")
            st.code(traceback.format_exc())
    return wrapper
```

### æ—¥å¿—é…ç½®
```python
# utils/logger.py
import logging
import streamlit as st

def setup_logger():
    """è®¾ç½®æ—¥å¿—ç³»ç»Ÿã€‚"""
    logging.basicConfig(
        level=logging.INFO,
        format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
        handlers=[
            logging.FileHandler('app.log'),
            logging.StreamHandler()
        ]
    )
    return logging.getLogger(__name__)
```

## å®‰å…¨é…ç½®

### è¾“å…¥éªŒè¯
```python
# utils/validation.py
def validate_triangle_sides(a, b, c):
    """éªŒè¯ä¸‰è§’å½¢è¾¹é•¿ã€‚"""
    if a <= 0 or b <= 0 or c <= 0:
        raise ValueError("è¾¹é•¿å¿…é¡»ä¸ºæ­£æ•°")
    if a + b <= c or a + c <= b or b + c <= a:
        raise ValueError("ä¸æ»¡è¶³ä¸‰è§’å½¢ä¸ç­‰å¼")
    return True
```

### æ•°æ®æ¸…ç†
```python
# utils/sanitization.py
def sanitize_input(value, min_val=0.1, max_val=1000):
    """æ¸…ç†ç”¨æˆ·è¾“å…¥ã€‚"""
    try:
        value = float(value)
        return max(min_val, min(max_val, value))
    except (ValueError, TypeError):
        return min_val
```

## æ‰©å±•å’Œå‡çº§

### åŠŸèƒ½æ‰©å±•

#### 1. æ–°æ¨¡å—æ·»åŠ 
```python
# æ·»åŠ æ–°æ¨¡å—æ¨¡æ¿
# pages/new_module.py
def new_module():
    """æ–°æ¨¡å—å®ç°ã€‚"""
    st.title("æ–°æ¨¡å—")
    # å®ç°é€»è¾‘
```

#### 2. æ’ä»¶ç³»ç»Ÿ
```python
# utils/plugin_system.py
class PluginManager:
    def __init__(self):
        self.plugins = {}
    
    def register_plugin(self, name, plugin):
        self.plugins[name] = plugin
    
    def get_plugin(self, name):
        return self.plugins.get(name)
```

### æŠ€æœ¯å‡çº§è·¯å¾„

#### 1. æ¡†æ¶å‡çº§
- Streamlit 2.x å…¼å®¹æ€§
- æ”¯æŒæ–°çš„å¯è§†åŒ–åº“
- é›†æˆWebAssemblyè®¡ç®—

#### 2. æ€§èƒ½å‡çº§
- ä½¿ç”¨Daskè¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—
- é›†æˆGPUåŠ é€Ÿ
- å®ç°æœåŠ¡ç«¯æ¸²æŸ“

#### 3. åŠŸèƒ½å‡çº§
- æ”¯æŒ3Då¯è§†åŒ–
- æ·»åŠ AR/VRåŠŸèƒ½
- å®ç°åä½œå­¦ä¹ 

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å­—ä½“æ˜¾ç¤ºé—®é¢˜
```python
# å­—ä½“é—®é¢˜æ’æŸ¥
import matplotlib.pyplot as plt
print(plt.rcParams['font.family'])
```

#### 2. å†…å­˜æ³„æ¼
```python
# å†…å­˜é—®é¢˜æ’æŸ¥
import psutil
import os

def check_memory():
    process = psutil.Process(os.getpid())
    return process.memory_info().rss / 1024 / 1024  # MB
```

#### 3. æ€§èƒ½é—®é¢˜
```python
# æ€§èƒ½é—®é¢˜æ’æŸ¥
import cProfile
import pstats

def profile_function(func):
    profiler = cProfile.Profile()
    profiler.enable()
    func()
    profiler.disable()
    
    stats = pstats.Stats(profiler)
    stats.sort_stats('cumulative')
    stats.print_stats()
```

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] ä¾èµ–åŒ…ç‰ˆæœ¬ç¡®è®¤
- [ ] ç¯å¢ƒå˜é‡é…ç½®
- [ ] ç«¯å£é…ç½®æ­£ç¡®
- [ ] æ—¥å¿—ç³»ç»Ÿé…ç½®
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] æ€§èƒ½ç›‘æ§å¯ç”¨
- [ ] å®‰å…¨é…ç½®æ£€æŸ¥
- [ ] å¤‡ä»½ç­–ç•¥åˆ¶å®š

### éƒ¨ç½²åéªŒè¯
- [ ] åº”ç”¨æ­£å¸¸å¯åŠ¨
- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æŒ‡æ ‡æ­£å¸¸
- [ ] æ—¥å¿—æ–‡ä»¶ç”Ÿæˆ
- [ ] é”™è¯¯ç›‘æ§æœ‰æ•ˆ
- [ ] ç”¨æˆ·è®¿é—®æ­£å¸¸
- [ ] èµ„æºä½¿ç”¨åˆç†

## ç›¸å…³æ–‡æ¡£

- [ä¸‰è§’å½¢åˆ†ç±»é¡µé¢å®ç°æ–‡æ¡£](1_ä¸‰è§’å½¢åˆ†ç±»_å®ç°æ–‡æ¡£.md)
- [å‹¾è‚¡å®šç†é¡µé¢å®ç°æ–‡æ¡£](2_å‹¾è‚¡å®šç†_å®ç°æ–‡æ¡£.md)
- [ç­‰é«˜æ¨¡å‹é¡µé¢å®ç°æ–‡æ¡£](3_ç­‰é«˜æ¨¡å‹_å®ç°æ–‡æ¡£.md)
- [ä¸€åŠæ¨¡å‹é¡µé¢å®ç°æ–‡æ¡£](4_ä¸€åŠæ¨¡å‹_å®ç°æ–‡æ¡£.md)
- [ç‡•å°¾æ¨¡å‹é¡µé¢å®ç°æ–‡æ¡£](5_ç‡•å°¾æ¨¡å‹_å®ç°æ–‡æ¡£.md)

---

*æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š2024å¹´*  
*æœ€åæ›´æ–°ï¼š2024å¹´*
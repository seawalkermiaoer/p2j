# 几何问题学习平台

这是一个使用 Streamlit 构建的交互式几何问题学习平台，旨在帮助用户通过可视化和交互式示例理解和掌握各种几何概念。项目采用模块化设计，每个几何主题都有独立的页面模块，便于扩展和维护。

## 🎯 功能特性

### 核心学习模块
- **三角形分类**: 学习按角（锐角、直角、钝角）和按边（等边、等腰、不等边）对三角形进行分类
- **勾股定理**: 探索勾股定理，通过交互式滑块调整边长，实时验证定理
- **等高模型**: 理解等高模型及其在三角形面积计算中的应用
- **一半模型**: 学习一半模型，了解三角形与平行四边形之间的面积关系
- **燕尾模型**: 掌握燕尾模型，解决更复杂的三角形面积问题
- **蝴蝶模型**: 通过交互式滑块，直观地看到蝴蝶模型的两个三角形是如何联动变化的，深刻理解它们“边长成比例”的关系

### 技术特色
- **交互式可视化**: 使用 Matplotlib 生成动态几何图形
- **实时计算**: 参数调整即时反映在图形和计算结果中
- **中文支持**: 完整的中文字体和界面支持
- **响应式设计**: 适配不同屏幕尺寸的设备

## 🚀 快速开始

### 环境要求
- Python 3.8 或更高版本
- pip 包管理器

### 安装步骤

1. **克隆仓库**:
   ```bash
   git clone https://github.com/your-username/p2j.git
   cd p2j
   ```

2. **创建并激活虚拟环境**:
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # Linux/Mac
   # 或
   venv\Scripts\activate     # Windows
   ```

3. **安装依赖**:
   ```bash
   pip install -r requirements.txt
   ```

4. **启动应用**:
   ```bash
   streamlit run streamlit_app.py
   ```

应用将在浏览器中自动打开（默认 http://localhost:8501）。

## 📁 项目结构

```
p2j/
├── .devcontainer/           # VS Code 开发容器配置
│   └── devcontainer.json
├── font/                    # 字体文件
│   └── SimHei.ttf          # 中文字体（黑体）
├── pages/                   # 学习页面模块（每个文件对应一个功能）
│   ├── 1_三角形分类.py      # 三角形分类学习页面
│   ├── 2_勾股定理.py        # 勾股定理验证页面
│   ├── 3_等高模型.py        # 等高模型演示页面
│   ├── 4_一半模型.py        # 一半模型学习页面
│   ├── 5_燕尾模型.py        # 燕尾模型演示页面
│   └── 8_蝴蝶模型.py        # 蝴蝶模型演示页面
├── utils/                   # 工具模块
│   ├── __init__.py         # 包初始化文件
│   └── fonts.py            # 字体配置工具
├── docs/                    # 项目文档
│   └── 1_三角形分类.md      # 三角形分类详细文档
├── requirements.txt        # 项目依赖
├── streamlit_app.py        # 应用主入口
└── README.md               # 项目说明文档
```

## 🛠️ 技术架构

### 核心技术栈
- **Streamlit**: Web 应用框架，用于快速构建交互式数据应用
- **NumPy**: 数值计算库，用于几何计算
- **Matplotlib**: 绘图库，用于生成几何图形
- **Python 3.8+**: 主要编程语言

### 架构设计
```
用户界面 (Streamlit)
    ↓
页面路由 (pages/*.py)
    ↓
几何计算引擎 (NumPy + 自定义算法)
    ↓
可视化渲染 (Matplotlib)
    ↓
字体管理 (utils/fonts.py)
```

## 🔧 开发实现过程

### 1. 项目初始化
项目采用 Streamlit 的多页面结构，每个几何主题作为独立的 Python 文件存放在 `pages/` 目录中。Streamlit 会自动识别这些文件并在侧边栏中创建导航菜单。

### 2. 字体配置
由于几何图形需要显示中文标签，项目配置了中文字体支持：

**utils/fonts.py**:
- 实现了 `setup_custom_font()` 函数
- 支持自定义字体路径配置
- 提供回退机制，确保中文正常显示
- 遵循 Google Python 风格指南

### 3. 页面模块设计
每个页面模块遵循统一的设计模式：

#### 标准页面结构
```python
# 1. 导入必要的库
import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
from utils.fonts import setup_custom_font

# 2. 设置页面配置
setup_custom_font()
st.set_page_config(page_title="页面标题", page_icon="📐")

# 3. 定义绘图函数
def draw_triangle(vertices):
    # 使用 Matplotlib 绘制几何图形
    fig, ax = plt.subplots()
    # ... 绘图逻辑
    return fig

# 4. 创建交互式界面
st.title("几何主题")
# ... Streamlit 组件和交互逻辑
```

#### 三角形分类页面实现
**pages/1_三角形分类.py**:
- **按角分类**: 锐角三角形、直角三角形、钝角三角形
- **按边分类**: 等边三角形、等腰三角形、不等边三角形
- **可视化实现**:
  - 使用坐标系精确绘制三角形
  - 标注角度和边长信息
  - 提供分类标准的数学解释
- **交互功能**:
  - 动态展示不同类型的三角形
  - 提供分类判断的逻辑说明

#### 勾股定理页面实现
**pages/2_勾股定理.py**:
- **定理验证**: 通过滑块调整直角三角形边长
- **实时计算**: 自动计算并验证 a² + b² = c²
- **图形展示**:
  - 绘制直角三角形
  - 标注各边长度
  - 显示计算过程
- **证明演示**: 提供勾股定理的图形化证明

#### 等高模型页面实现
**pages/3_等高模型.py**:
- **面积计算**: 演示等高三角形的面积关系
- **参数调整**: 通过滑块改变底边长度和高度
- **对比展示**: 同时显示多个等高三角形
- **数学原理**: 解释面积公式的推导过程

#### 一半模型页面实现
**pages/4_一半模型.py**:
- **面积关系**: 演示三角形与平行四边形的面积关系
- **动态演示**: 通过参数调整展示面积变化
- **数学证明**: 提供面积关系的图形化证明

#### 燕尾模型页面实现
**pages/5_燕尾模型.py**:
- **复杂面积**: 处理多个三角形组合的面积计算
- **分割演示**: 展示如何将复杂图形分解为简单三角形
- **计算验证**: 提供面积计算的验证方法

### 4. 数学计算引擎
每个页面都包含专门的几何计算函数：

#### 三角形计算
```python
def calculate_triangle_area(a, b, c):
    # 使用海伦公式计算三角形面积
    s = (a + b + c) / 2
    area = np.sqrt(s * (s - a) * (s - b) * (s - c))
    return area

def calculate_angle(a, b, c):
    # 使用余弦定理计算角度
    angle = np.arccos((a**2 + b**2 - c**2) / (2 * a * b))
    return np.degrees(angle)
```

#### 坐标计算
```python
def get_triangle_vertices(a, b, c):
    # 根据边长计算三角形顶点坐标
    A = (0, 0)
    B = (c, 0)
    # 使用余弦定理计算第三个顶点
    x = (a**2 + c**2 - b**2) / (2 * c)
    y = np.sqrt(a**2 - x**2)
    C = (x, y)
    return [A, B, C]
```

### 5. 可视化优化
- **图形样式**: 统一的颜色方案和线条样式
- **标签显示**: 中文标签和数学符号的正确显示
- **交互响应**: 参数变化时的平滑过渡
- **导出功能**: 支持将图形保存为图片

### 6. 错误处理与边界情况
- **输入验证**: 确保几何参数的有效性
- **数学边界**: 处理退化和无效三角形的情况
- **用户体验**: 提供清晰的错误提示和解决建议

## 📊 依赖管理

**requirements.txt**:
```
streamlit>=1.28,<2.0    # Web 应用框架
numpy>=1.23,<3.0        # 数值计算
matplotlib>=3.6,<4.0    # 绘图库
```

### 版本兼容性
- 支持 Python 3.8+
- 跨平台支持（Windows、macOS、Linux）
- 浏览器兼容性：Chrome、Firefox、Safari、Edge

## 🎯 使用指南

### 学生用户
1. 启动应用后，从侧边栏选择感兴趣的几何主题
2. 使用滑块和输入框调整参数
3. 观察图形变化，理解几何概念
4. 阅读数学解释和证明过程

### 教师用户
1. 可以使用投影模式进行课堂演示
2. 调整参数展示不同的几何情况
3. 导出图形用于教学材料制作

### 开发者
1. 查看 `pages/` 目录下的示例代码
2. 使用 `utils/fonts.py` 中的字体工具
3. 遵循现有的代码结构和风格

## 🔍 故障排除

### 常见问题
1. **中文显示异常**
   - 确保 `font/SimHei.ttf` 文件存在
   - 检查字体文件权限

2. **依赖安装失败**
   - 使用 Python 3.8+ 版本
   - 确保 pip 为最新版本：`pip install --upgrade pip`

3. **应用启动失败**
   - 检查端口 8501 是否被占用
   - 查看终端错误信息进行调试

### 调试建议
```bash
# 查看详细错误信息
streamlit run streamlit_app.py --logger.level=debug

# 检查依赖版本
pip list
```

## 🤝 贡献指南

### 开发环境设置
1. Fork 项目仓库
2. 创建功能分支：`git checkout -b feature/new-feature`
3. 安装开发依赖：`pip install -r requirements.txt`
4. 进行开发并测试
5. 提交 Pull Request

### 代码规范
- 遵循 Google Python 风格指南
- 使用有意义的变量名和函数名
- 添加适当的注释和文档字符串
- 每个新功能需要包含对应的测试

### 添加新几何主题
1. 在 `pages/` 目录创建新的 Python 文件
2. 遵循现有页面的结构和风格
3. 确保包含完整的数学解释
4. 更新 README.md 的功能列表

## 📄 许可证

本项目使用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 [Issue](https://github.com/your-username/p2j/issues)
- 发送邮件至：your-email@example.com

## 🗺️ 路线图

### 近期计划
- [ ] 添加更多几何主题（圆的性质、相似三角形等）
- [ ] 实现图形导出为 SVG 格式
- [ ] 添加学习进度跟踪功能

### 长期目标
- [ ] 支持 3D 几何图形展示
- [ ] 添加用户账户系统
- [ ] 实现离线版本
- [ ] 支持移动端应用

---

*最后更新：2024年*